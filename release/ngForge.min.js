/*!
 * Copyright 2015 Thinking Bytes Ltd.
 *
 * ngForge, v0.1.0
 * Angular wrappers for Trigger.io (forge) modules.
 * http://trigger.io/
 * http://angularjs.org/
 *
 * By @arolave <3
 *
 * Licensed under the MIT license. Please see LICENSE for more information.
 *
 */

!function(){angular.module("ngForge",[]),angular.module("ngForge").constant("forgeConfig",{testConnectionUrl:"ping"}),angular.module("ngForge").factory("forge",function(e,n,t,r){"use strict";var o;return o={dummy:!0,is:{web:function(){return!0},mobile:function(){return!1},android:function(){return!1},ios:function(){return!1},connection:{_connected:!1,connected:function(){return this._connected},wifi:function(){return this._connected}}},event:{messagePushed:{addListener:function(e,n){return void 0}},appPaused:{addListener:function(e,n){return void 0}},appResumed:{addListener:function(e,n){return void 0}},backPressed:{addListener:function(e,n){return void 0},preventDefault:function(e,n){return void 0}},connectionStateChange:{listeners:[],addListener:function(e,n){return void this.listeners.push(e)}}},testConnection:function(){var e;return e=function(e){return function(n){return e.is.connection._connected=n,e.event.connectionStateChange.listeners.forEach(function(e){return e()})}}(this),t.get(r.testConnectionUrl).then(function(n){return function(){return n.is.connection._connected?void 0:e(!0)}}(this))["catch"](function(n){return function(){return n.is.connection._connected?e(!1):void 0}}(this))}},e.forge?e.forge:(o.testConnection(),n(function(){return o.testConnection()},5e3),o)}),angular.module("ngForge").provider("contact",function(){"use strict";return{$get:function(e,n,t,r,o){return t.dummy&&o.debug("using contactDummy for playing images"),t.dummy?this.contactDummy(r,o):this.forgeContact(t)},contactDummy:function(e,n){return{_examples:[{id:"14894",displayName:"Gal Goltzman",name:{formatted:"Gal Goltzman",familyName:"Goltzman",givenName:"Gal",middleName:null,honorificPrefix:"",honorificSuffic:null},nickname:"",phoneNumbers:[{value:"+972574712441",type:"mobile",pref:!1}],photos:[{value:"data:image/jpg;base64,ABCDEF1234",type:null,pref:!1}]},{id:"148900",displayName:"Tom",name:{formatted:"Tom",familyName:"",givenName:"Tom",middleName:null,honorificPrefix:"",honorificSuffic:null},nickname:"",phoneNumbers:[{value:"+972 51-5097756+13",type:"mobile",pref:!1}],photos:[{value:"data:image/jpg;base64,ABCDEF1234",type:null,pref:!1}]},{id:"14894",displayName:"Brigid",name:{formatted:"Brigid",familyName:"",givenName:"Brigid",middleName:null,honorificPrefix:"",honorificSuffic:null},nickname:"",phoneNumbers:[{value:"+447817471244",type:"mobile",pref:!1}],photos:[{value:"data:image/jpg;base64,ABCDEF1234",type:null,pref:!1}]},{id:"14895",displayName:"Eddie Fenech",name:{formatted:"Eddie Fenech",familyName:"Fenech",givenName:"Eddie",middleName:null,honorificPrefix:"",honorificSuffic:null},nickname:"",phoneNumbers:[{value:"+447432112312",type:"mobile",pref:!1}],photos:[{value:"data:image/jpg;base64,ABCDEF1234",type:null,pref:!1}]},{id:"122",displayName:"Aro",name:{formatted:"Aro",familyName:"Aro"},nickname:"",phoneNumbers:[{value:"+9727963587331",type:"mobile",pref:!1}]},{id:"299",displayName:"Bad Phone",name:{formatted:"Bad Phone",familyName:"BPhone"},nickname:"",phoneNumbers:[{value:"+97288898",type:"mobile",pref:!1}]},{id:"1",displayName:"Guy kedara",name:{formatted:"Guy kedara",familyName:"kedara",givenName:"Guy",middleName:null,honorificPrefix:"",honorificSuffic:null},nickname:"",phoneNumbers:[{value:"+44732112324",type:"mobile",pref:!1}]},{id:"690",displayName:"Dodgy Bro",name:{formatted:"Dodgy Bro",familyName:"Bro",givenName:"Dodgy",middleName:null,honorificPrefix:"",honorificSuffic:null},nickname:"Doge",phoneNumbers:[{value:"+972 547929796",type:"mobile",pref:!1}]},{id:"691",displayName:"Toby Bro",name:{formatted:"Toby Bro",familyName:"Bro",givenName:"Toby",middleName:null,honorificPrefix:"",honorificSuffic:null},nickname:"Tobe",phoneNumbers:[{value:"+972-4324-1324",type:"work",pref:!1}]},{id:"2",displayName:"Mr Joe Carstairs",name:{formatted:"Joe Carstairs",familyName:"Carstairs",givenName:"Joe",middleName:null,honorificPrefix:"",honorificSuffic:null},nickname:"Joey",phoneNumbers:[{value:"+447321123324",type:"mobile",pref:!1}],photos:[{value:"data:image/jpg;base64,ABCDEF1234",type:null,pref:!1}]},{id:"3",displayName:"Lucy Cleaner",name:{formatted:"Lucy Cleaner",familyName:"Cleaner",givenName:"Lucy",middleName:"middle",honorificPrefix:"",honorificSuffic:null},nickname:"",phoneNumbers:[{value:"+447321132131",type:"mobile",pref:!1}],photos:[{value:"data:image/jpg;base64,ABCDEF1234",type:null,pref:!1}]},{id:"33",displayName:"Ches",name:{formatted:"Ches",familyName:"",givenName:"Ches",middleName:"",honorificPrefix:"",honorificSuffic:null},nickname:"",phoneNumbers:[{value:"0543742342",type:"mobile",pref:!1}],photos:[{value:"data:image/jpg;base64,ABCDEF1234",type:null,pref:!1}]},{id:"4",displayName:"sarit",name:{formatted:"sarit",familyName:"",givenName:"sarit",middleName:null,honorificPrefix:"",honorificSuffic:null},nickname:"tush",phoneNumbers:[{value:"+972547434302",type:"work",pref:!1},{value:"+972723131231",type:"home",pref:!1},{value:"+447312311232",type:"mobile",pref:!1}],photos:[{value:"data:image/jpg;base64,ABCDEF1234",type:null,pref:!1}]}],select:function(e,t){return n.debug("select"),"function"==typeof e?e():void 0},selectAll:function(t,r,o){return e.isFunction(t)&&(t=["id","displayName"],r=t,o=r),n.debug("selectAll"),"function"==typeof r?r(this._examples.map(function(n){return e.pick(n,t)})):void 0},selectById:function(t,r,o){return n.debug("selectById"),"function"==typeof r?r(e.find(this._examples,function(e){return e.id===t})):void 0}}},forgeContact:function(e){return e.contact}}}),angular.module("ngForge").provider("facebook",function(){"use strict";return{$get:function(e,n,t){return n.dummy&&t.debug("using $facebook for comms"),n.dummy?this.ngFacebook():this.forgeFacebook(n)},ngFacebook:function(){return{authorize:function(e,n,t,r){return t({access_token:"dfs",access_expires:"never",granted:!0,denied:!1})},hasAuthorized:function(e,n,t,r){return t({access_token:"dfs",access_expires:"never",granted:!1,denied:!1})},logout:function(e,n){return e()},api:function(e,n,t,r,o){return r(!0)},ui:function(e,n,t){return n(!0)},installed:function(e,n){return e(!0)},getKeyHash:function(e,n){return e("5453425284625867")}}},forgeFacebook:function(e){return e.facebook}}}),angular.module("ngForge").provider("forgeFile",function(){"use strict";return{$get:function(e,n,t,r,o){return t.dummy&&o.debug("using fileDummy"),t.dummy?this.fileDummy(n,t,r):this.forgeFile(t,r)},fileDummy:function(e,n,t){return n.file={isFile:function(e,n){return n(!!(null!=e?e.uri:void 0))},getLocal:function(e,n){return n({uri:e})},cacheURL:function(e,n,t){return n({uri:e})},URL:function(e,n){return n(e.uri)},remove:function(e,n){return n()}},t.mapValues(n.file,function(e){return t.lift(n.file,e)})},forgeFile:function(e,n){return n.mapValues(e.file,function(t){return n.lift(e.file,t)})}}}),angular.module("ngForge").provider("httpProxy",function(e){"use strict";return{$get:function(e,n,t,r,o,u,i,a){return u.dummy&&a.debug("using $http for comms"),u.dummy?this.ngHttp(e,o,a):this.forgeHttp(e,n,t,r,o,u,i,a)},httpProvider:e,ngHttp:function(e,n,t){return{request:function(n){switch(n.swMethod){case"upload":return this.upload(n.url,n);default:return e(n)}},get:function(n,r){return t.log("ngget:"+n),e.get(n,r)},jsonp:function(n,r){return t.log("ngjsonp:"+n),e.jsonp(n,r)},post:function(n,r,o){return t.log("ngpost:"+n+":"+r),e.post(n,r,o)},put:function(n,r,o){return t.log("ngput:"+n+":"+r),e.put(n,r,o)},"delete":function(n,r){return t.log("ngdelete:"+n),e["delete"](n,r)},upload:function(e,r){return t.log("ngpupload:"+e),r.swMethod="upload",r.url=e,n.upload(r)}}},forgeHttp:function(e,n,t,r,o,u,i,a){var f;return a.debug("using forge for comms"),f=[],angular.forEach(this.httpProvider.interceptors,function(e){return f.unshift(angular.isString(e)?n.get(e):n.invoke(e))}),{_convertRequest:function(e){return e.accepts=["application/json"],null==e.file&&(e.dataType=e.responseType||"json"),e.type=e.method.toUpperCase(),null!=e.file&&(e.files=[e.file],delete e.file),e},request:function(n){switch(n.swMethod){case"upload":return this.upload(n.url,n);case"jsonp":return e(n);default:return this._doRequest(n.method,n.url,n)}},get:function(e,n){return this._getRequest(e,n)},post:function(e,n,t){return this._dataRequest("POST",e,n,t)},put:function(e,n,t){return this._dataRequest("PUT",e,n,t)},patch:function(e,n,t){return this._dataRequest("PATCH",e,n,t)},"delete":function(e,n){return this._basicRequest("DELETE",e,n)},jsonp:function(n,t){return t.swMethod="jsonp",e.jsonp(n,t)},upload:function(e,n){return n.swMethod="upload",a.log("upload: "+e),n.url=e,o.upload(n)},_dataRequest:function(e,n,t,r){return this._doRequest(e,n,angular.extend(r||{},{data:JSON.stringify(t)}))},_getRequest:function(e,n){var r,o,u,a,f,s,c,l;if(u=t.defer(),s=u.promise,i.isObject(null!=n?n.cache:void 0)&&(r=null!=n?n.cache:void 0),f=function(e){return e>=200&&300>e},c=function(e,t,r,o){return t=Math.max(t,0),(f(t)?u.resolve:u.reject)({data:e,status:t,headers:r,config:n,statusText:o})},l=function(e){return c(e.data,e.status,i.safeClone(e.headers),e.statusText)},r){if(o=r.get(e),null!=o)return i.isFunction(o.then)?o.then(l,l):Array.isArray(o)?c(o[1],o[0],i.safeClone(o[2]),o[3]):c(o,200,{},"OK"),s;r.put(e,s)}return a=function(n){return r&&(f(n.status)?r.put(e,[n.status,n.data,n.headers,n.statusText]):r.remove(e)),l(n)},this._basicRequest("GET",e,n).then(a,a),s},_basicRequest:function(e,n,t){return t&&t.params?this._doRequest(e,n,angular.extend(t||{},{data:t.params})):this._doRequest(e,n,t)},_forgeRequester:function(e){var n;return a.debug("_forgeRequester"),n=t.defer(),e.success=function(t,o){return a.debug("success"),a.debug(t),n.resolve({status:200,data:t,headers:o,config:e}),r.$$phase?void 0:r.$apply()},e.error=function(e){var t,o;a.debug("error "+JSON.stringify(e)),a.error(e.statusCode+" "+e.content),o=400;try{o=parseInt(e.statusCode)}catch(u){}t=e.content;try{t=JSON.parse(e.content)}catch(u){}return n.reject({status:o,data:t,headers:{}}),r.$$phase?void 0:r.$apply()},u.request.ajax(e),n.promise},_doRequest:function(e,n,r){var o,u,i,s,c;for(a.log("forge"+e.toLowerCase()+":"+n+":"+((null!=r?r.data:void 0)?JSON.stringify(r.data):void 0)),u=this._convertRequest(angular.extend(r||{},{method:e,url:n,contentType:"application/json; charset=utf-8"})),a.debug(JSON.stringify(u)),i=t.when(u),o=[this._forgeRequester,void 0],angular.forEach(f,function(e){return(e.request||e.requestError)&&o.unshift(e.request,e.requestError),e.response||e.responseError?o.push(e.response,e.responseError):void 0});o.length;)c=o.shift(),s=o.shift(),i=i.then(c,s);return i.success=function(e){return i.then(function(n){return e(n.data,n.status,n.headers,r)}),i},i.error=function(e){return i["catch"](function(n){var t;return t=function(){try{return JSON.parse(n.data)}catch(e){return n.data}}(),e(t,n.status,n.headers,r)}),i},i}}}}}),angular.module("ngForge").provider("ionic_keyboard",function(){"use strict";return{$get:function(e,n,t,r){return t.dummy&&r.debug("using ionicKeyboardDummy for keyboardcontrol"),t.dummy?this.ionicKeyboardDummy(r):this.forgeIonicKeyboard(t)},ionicKeyboardDummy:function(e){return{disableScroll:function(n,t){return e.info("ionic_keyboard.disableScroll("+n+")"),"function"==typeof t?t():void 0},hideKeyboardAccessoryBar:function(n,t){return e.info("ionic_keyboard.hideKeyboardAccessoryBar("+n+")"),"function"==typeof t?t():void 0},isKeyboardVisible:function(n){return e.info("ionic_keyboard.isKeyboardVisible"),"function"==typeof n?n():void 0},close:function(n){return e.info("ionic_keyboard.close"),"function"==typeof n?n():void 0}}},forgeIonicKeyboard:function(e){return e.ionic_keyboard}}}),angular.module("ngForge").factory("logger",function(e){"use strict";var n,t,r,o,u,i,a;return window.forge&&window.forge.is&&window.forge.is.mobile()?(n=function(n){var t;return n=Array.prototype.slice.call(n),t=e.filter(n,function(e){return e&&e instanceof Error}),t&&t.length?t[0]:void 0},a=function(e){return Array.prototype.slice.call(e).toString()},o=[],t=function(e){return u("â–¾ "+e),o.push(e)},r=function(){return o.pop()},u=function(e,n,r){null==r&&(r=forge.logging.log);for(var o="",u=0;u<t.length;++u)o+="| ";return r(o+e,n)},i={log:function(){return u(a(arguments),n(arguments))},debug:function(){return u(a(arguments),n(arguments),forge.logging.debug)},info:function(){return u(a(arguments),n(arguments),forge.logging.info)},warn:function(){return u(a(arguments),n(arguments),forge.logging.warn)},error:function(){return u(a(arguments),n(arguments),forge.logging.error)},critical:function(){return u(a(arguments),n(arguments),forge.logging.critical)},group:t,groupCollapsed:t,groupEnd:r}):console}),angular.module("ngForge").provider("media",function(){"use strict";return{$get:function(e,n,t,r){return t.dummy&&r.debug("using mediaDummy for playing images"),t.dummy?this.mediaDummy(r):this.forgeMedia(t)},mediaDummy:function(e){return{playerDummy:{play:function(e){return"function"==typeof e?e():void 0}},createAudioPlayer:function(n,t,r){return e.info("create dummy player "+n),"function"==typeof t?t(this.playerDummy):void 0}}},forgeMedia:function(e){return e.media}}}),angular.module("ngForge").provider("parse",function(){"use strict";return{$get:function(e,n,t,r,o){return t.dummy&&o.debug("using parseDummy for notifications"),t.dummy?this.parseDummy(r,o):this.forgeParse(t)},parseDummy:function(e,n){var t;return t=[""],{installationInfo:function(e){return n.info("parseDummy info"),e({id:-696969})},registerForNotifications:function(e,n){return e()},push:{subscribe:function(r,o,u){return n.info("subscribing to "+r),e.includes(t,r)||t.push(r),"function"==typeof o?o():void 0},unsubscribe:function(r,o,u){return n.info("unsubscribing from "+r),t=e.without(t,r),"function"==typeof o?o():void 0},subscribedChannels:function(e,n){return"function"==typeof e?e(t):void 0}}}},forgeParse:function(e){return e.parse}}}),angular.module("ngForge").provider("platform",function(){"use strict";return{$get:function(e,n,t,r){return t.dummy&&r.debug("using platformDummy for playing images"),t.dummy?this.platformDummy():this.forgePlatform(t)},platformDummy:function(){return{getModel:function(e,n){return e("X")},getVersion:function(e,n){return e("1")},getAPILevel:function(e,n){return e("1")},getManufacturer:function(e,n){return e("X")}}},forgePlatform:function(e){return e.platform}}}),angular.module("ngForge").provider("prefs",function(){"use strict";return{$get:function(e,n,t,r,o){return r.dummy&&o.debug("using prefsDummy for playing images"),r.dummy?this.prefsDummy(n,o):this.forgePrefs(r)},prefsDummy:function(e,n){return{prefsObj:function(){return null!=e.prefs?e.prefs:e.prefs={}},get:function(e,t,r){var o;try{return"function"==typeof t?t(this.prefsObj()[e]):void 0}catch(u){o=u,n.error(o.message),"function"==typeof r&&r(o)}},set:function(e,t,r,o){var u;try{return this.prefsObj()[e]=t,"function"==typeof r?r():void 0}catch(i){return u=i,n.error(u.message),"function"==typeof o?o(u):void 0}},clear:function(e,t,r){var o;try{return delete this.prefsObj()[e],"function"==typeof t?t():void 0}catch(u){return o=u,n.error(o.message),"function"==typeof r?r(o):void 0}},clearAll:function(t,r){var o;try{return delete e._prefs,"function"==typeof t?t():void 0}catch(u){return o=u,n.error(o.message),"function"==typeof r?r(o):void 0}},keys:function(e,t){var r,o;try{return o=this.prefsObj(),e(o?Object.keys(o):void 0)}catch(u){return r=u,n.error(r.message),t(r)}}}},forgePrefs:function(e){return e.prefs}}}),angular.module("ngForge").provider("segmentio",function(){"use strict";return{$get:function(e,n,t,r){return t.dummy&&r.debug("using segmentioDummy"),t.dummy?this.segmentioDummy(r):this.forgeSegmentio(t)},segmentioDummy:function(e){return{identify:function(n,t,r,o){return e.debug("identify"),"function"==typeof r?r():void 0},track:function(n,t,r,o){return e.debug("track"),"function"==typeof r?r():void 0},screen:function(n,t,r,o){return e.debug("screen"),"function"==typeof r?r():void 0}}},forgeSegmentio:function(e){return e.segmentio}}}),angular.module("ngForge").provider("sms",function(){"use strict";return{$get:function(e,n,t,r){return t.dummy&&r.debug("using smsDummy for playing images"),t.dummy?this.smsDummy(r):this.forgeSms(t)},smsDummy:function(e){return{send:function(n,t,r){return e.debug("sms.send "+n.body+" to "+JSON.stringify(n.to)),"function"==typeof t?t():void 0}}},forgeSms:function(e){return e.sms}}}),angular.module("ngForge").factory("forgeUtils",function(e){"use strict";var n=[].slice;return{funcTag:"[object Function]",genTag:"[object GeneratorFunction]",filter:function(e,n){var t,r,o,u;if(!e)return void 0;for(t=[],r=0,o=e.length;o>r;r++)u=e[r],n(u)&&t.push(u);return t},find:function(e,n){var t,r,o;if(!e)return void 0;for(t=0,r=e.length;r>t;t++)if(o=e[t],n(o))return o;return void 0},includes:function(e,n){var t,r,o;if(!e)return void 0;for(t=0,r=e.length;r>t;t++)if(o=e[t],o===n)return!0;return!1},isFunction:function(e){var n;return n=this.isObject(e)?Object.prototype.toString.call(e):"",n===this.funcTag||n===this.genTag},isObject:function(e){var n;return n=typeof e,"object"===n||"function"===n},lift:function(t,r){return function(){var o,u,i,a,f;return u=1<=arguments.length?n.call(arguments,0):[],i=e.defer(),f=function(){return arguments&&1===arguments.length?i.resolve(arguments[0]):i.resolve(arguments)},a=function(){return arguments&&1===arguments.length?i.reject(arguments[0]):i.reject(arguments)},o=u.concat([f,a]),r.apply(t,o),i.promise}},liftGlobalFn:function(e){return this.lift(null,e)},mapValues:function(e,n){var t,r,o,u,i;if(!e)return e;if(t={},!e)return t;for(i=Object.keys(e),r=0,u=i.length;u>r;r++)o=i[r],t[o]=n(e[o]);return t},pick:function(e,n){var t,r,o,u;if(!e)return e;for(t={},r=0,u=n.length;u>r;r++)o=n[r],t[o]=e[o];return t},safeClone:function(e){return e?e.clone():void 0},without:function(e,n){var t,r,o,u;if(!e)return e;for(t=[],r=0,o=e.length;o>r;r++)u=e[r],u!==n&&t.push(u);return t}}})}();